{
	"Golang errors": {},
	"Issues": [
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "78",
				"url": "https://cwe.mitre.org/data/definitions/78.html"
			},
			"rule_id": "G204",
			"details": "Subprocess launched with variable",
			"file": "/home/f3rg/src/github/conexus/internal/process/manager.go",
			"code": "64: \n65: \tcmd := exec.CommandContext(processCtx, agentBinary)\n66: \n",
			"line": "65",
			"column": "9",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/home/f3rg/src/github/conexus/internal/testing/integration/helpers.go",
			"code": "170: \t\t// Read file content\n171: \t\tcontent, err := os.ReadFile(fullPath)\n172: \t\tif err != nil {\n",
			"line": "171",
			"column": "19",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/home/f3rg/src/github/conexus/internal/orchestrator/state/persistence.go",
			"code": "154: \n155: \tdata, err := os.ReadFile(cachePath)\n156: \tif err != nil {\n",
			"line": "155",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/home/f3rg/src/github/conexus/internal/orchestrator/state/persistence.go",
			"code": "62: \n63: \tdata, err := os.ReadFile(sessionPath)\n64: \tif err != nil {\n",
			"line": "63",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/home/f3rg/src/github/conexus/internal/indexer/walker.go",
			"code": "274: \n275: \tdata, err := os.ReadFile(path)\n276: \tif err != nil {\n",
			"line": "275",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/home/f3rg/src/github/conexus/internal/indexer/merkle.go",
			"code": "285: \n286: \tfile, err := os.Open(path)\n287: \tif err != nil {\n",
			"line": "286",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/home/f3rg/src/github/conexus/internal/indexer/indexer_impl.go",
			"code": "188: \t\t// Read file content\n189: \t\tcontent, err := os.ReadFile(fullPath)\n190: \t\tif err != nil {\n",
			"line": "189",
			"column": "19",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/home/f3rg/src/github/conexus/internal/indexer/indexer_impl.go",
			"code": "62: \t\t// Read file content\n63: \t\tcontent, err := os.ReadFile(path)\n64: \t\tif err != nil {\n",
			"line": "63",
			"column": "19",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "MEDIUM",
			"confidence": "HIGH",
			"cwe": {
				"id": "22",
				"url": "https://cwe.mitre.org/data/definitions/22.html"
			},
			"rule_id": "G304",
			"details": "Potential file inclusion via variable",
			"file": "/home/f3rg/src/github/conexus/internal/config/config.go",
			"code": "169: \t\n170: \tdata, err := os.ReadFile(safePath)\n171: \tif err != nil {\n",
			"line": "170",
			"column": "15",
			"nosec": false,
			"suppressions": null,
			"autofix": "Consider using os.Root to scope file access under a fixed root (Go \u003e=1.24). Prefer root.Open/root.Stat over os.Open/os.Stat to prevent directory traversal."
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/internal/vectorstore/sqlite/store.go",
			"code": "37: \tif err := store.initSchema(); err != nil {\n38: \t\tdb.Close()\n39: \t\treturn nil, fmt.Errorf(\"init schema: %w\", err)\n",
			"line": "38",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/internal/testing/integration/helpers.go",
			"code": "203: \t\tif err := os.WriteFile(fullPath, []byte(content), 0600); err != nil {\n204: \t\t\tos.RemoveAll(tmpDir)\n205: \t\t\treturn \"\", fmt.Errorf(\"failed to write file %s: %w\", filename, err)\n",
			"line": "204",
			"column": "4",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/internal/testing/integration/helpers.go",
			"code": "197: \t\tif err := os.MkdirAll(filepath.Dir(fullPath), 0700); err != nil {\n198: \t\t\tos.RemoveAll(tmpDir)\n199: \t\t\treturn \"\", fmt.Errorf(\"failed to create directory for %s: %w\", filename, err)\n",
			"line": "198",
			"column": "4",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/internal/protocol/jsonrpc.go",
			"code": "162: \t\tif err != nil {\n163: \t\t\ts.sendError(req.ID, InternalError, err.Error(), nil)\n164: \t\t\tcontinue\n",
			"line": "163",
			"column": "4",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/internal/protocol/jsonrpc.go",
			"code": "155: \t\tif req.Method == \"\" {\n156: \t\t\ts.sendError(req.ID, InvalidRequest, \"method required\", nil)\n157: \t\t\tcontinue\n",
			"line": "156",
			"column": "4",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/internal/protocol/jsonrpc.go",
			"code": "150: \t\tif req.JSONRPC != JSONRPCVersion {\n151: \t\t\ts.sendError(req.ID, InvalidRequest, \"invalid jsonrpc version\", nil)\n152: \t\t\tcontinue\n",
			"line": "151",
			"column": "4",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/internal/indexer/indexer_impl.go",
			"code": "469: \tif err := os.Rename(tempPath, sm.statePath); err != nil {\n470: \t\tos.Remove(tempPath) // Clean up on failure\n471: \t\treturn fmt.Errorf(\"rename state file: %w\", err)\n",
			"line": "470",
			"column": "3",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/cmd/conexus/main.go",
			"code": "452: \tw.WriteHeader(http.StatusOK) // JSON-RPC errors still use 200 OK\n453: \tjson.NewEncoder(w).Encode(resp)\n454: }\n",
			"line": "453",
			"column": "2",
			"nosec": false,
			"suppressions": null
		},
		{
			"severity": "LOW",
			"confidence": "HIGH",
			"cwe": {
				"id": "703",
				"url": "https://cwe.mitre.org/data/definitions/703.html"
			},
			"rule_id": "G104",
			"details": "Errors unhandled",
			"file": "/home/f3rg/src/github/conexus/cmd/conexus/main.go",
			"code": "426: \tw.WriteHeader(http.StatusOK)\n427: \tjson.NewEncoder(w).Encode(resp)\n428: }\n",
			"line": "427",
			"column": "2",
			"nosec": false,
			"suppressions": null
		}
	],
	"Stats": {
		"files": 59,
		"lines": 14371,
		"nosec": 2,
		"found": 18
	},
	"GosecVersion": "dev"
}